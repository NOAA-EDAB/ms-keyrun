<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mskeyrun">
<title>MS Keyrun - GB survey footprint â€¢ mskeyrun</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MS Keyrun - GB survey footprint">
<meta property="og:description" content="mskeyrun">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mskeyrun</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/mskeyrun.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Data Needs</h6>
    <a class="dropdown-item" href="../articles/DataNeeds.html">Project outline</a>
    <a class="dropdown-item" href="../articles/DatasetDimensions.html">Dataset Dimensions</a>
    <a class="dropdown-item" href="../articles/SpeciesEnvDat.html">Keyrun Species, Environment, Data Formats</a>
    <a class="dropdown-item" href="../articles/CompsDat.html">Age, Length, Diet</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Georges Bank</h6>
    <a class="dropdown-item" href="../articles/GBSurveySet.html">GB Survey Footprint</a>
    <a class="dropdown-item" href="../articles/allocateLandingsEPU.html">Allocate Landings to GB</a>
    <a class="dropdown-item" href="../articles/stockAreas.html">Stock areas</a>
    <a class="dropdown-item" href="../articles/GBsurveycatchviz.html">Focal species biomass and catch on GB</a>
    <a class="dropdown-item" href="../articles/GBdietcomp.html">Focal species diets on GB</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Simulated Data</h6>
    <a class="dropdown-item" href="../articles/SimData.html">Generating Simulated Data</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Assigning Fleets</h6>
    <a class="dropdown-item" href="../articles/GBFleetDefinitions.html">Analysis of catch by gear</a>
    <a class="dropdown-item" href="../articles/GBFleetDecisions.html">Fleet Definitions</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Length &amp; Age Based Data</h6>
    <a class="dropdown-item" href="../articles/GBLandingLengthDataSources.html">Data Sources</a>
    <a class="dropdown-item" href="../articles/GBLandingsByLength.html">Landings by Length</a>
    <a class="dropdown-item" href="../articles/GBLandingsByAge.html">Landings by Age</a>
    <a class="dropdown-item" href="../articles/GBLengthWeight.html">Length Weight Relationships</a>
    <a class="dropdown-item" href="../articles/GBbiomassNumbyLength.html">Survey Biomass and Abundance</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/NOAA-EDAB/ms-keyrun/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>MS Keyrun - GB survey footprint</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/NOAA-EDAB/ms-keyrun/blob/HEAD/vignettes/GBSurveySet.Rmd" class="external-link"><code>vignettes/GBSurveySet.Rmd</code></a></small>
      <div class="d-none name"><code>GBSurveySet.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="georges-bank---fisheries-survey-footprint">Georges Bank - Fisheries Survey Footprint<a class="anchor" aria-label="anchor" href="#georges-bank---fisheries-survey-footprint"></a>
</h2>
<div class="section level3">
<h3 id="spatial-2-approaches-for-georges-bank">Spatial: 2 Approaches for Georges Bank<a class="anchor" aria-label="anchor" href="#spatial-2-approaches-for-georges-bank"></a>
</h3>
<p>During the June/July survey <a href="https://noaa-edab.github.io/ms-keyrun/DatasetDimensions.html" target="_blank"> (Year, season, area decisions - 8 July 2020) </a> there were two approaches proposed for the spatial footprint of Georges Bank. The ideal footprint would be to define using Georges Bank EPU, scale fisheries catch for each species from stat areas to GB EPU footprint using ratios in spatially explicit VTR subset of catch data.</p>
<p>While work is ongoing towards segregating the fisheries dependent data, there is a decision to make about how to use the fisheries independent survey. The current definition of the EPU is based on ten-minute squares which does not fit with the survey design. This leaves several options of how to use the survey data. The first set of options is to use the survey design and assign survey strata to Georges Bank. The second set of options is to ignore the survey design and either post-stratify or take a simple average within the EPU.</p>
</div>
<div class="section level3">
<h3 id="opt1">Option 1 - use survey design<a class="anchor" aria-label="anchor" href="#opt1"></a>
</h3>
<p>The NEFSC bottom trawl survey uses a stratified random design. The rationale behind a stratified random design is to minimize variance. The figure below shows the full range of strata with the Georges Bank EPU overlaid in red. As you will notice, some of the survey strata extend beyond the EPU boundary. There are several ways that this can be accounted for. The simplest option is to include all strata that are partially within the EPU boundary.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in shape files and plot</span></span>
<span><span class="va">coast</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span>dsn<span class="op">=</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data-raw/gis"</span><span class="op">)</span>, layer<span class="op">=</span><span class="st">'NES_LME_coast'</span>, quiet<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">.</span>,crs<span class="op">=</span><span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span>dsn<span class="op">=</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data-raw/gis"</span><span class="op">)</span>, layer<span class="op">=</span><span class="st">'strata'</span>, quiet<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">.</span>,crs<span class="op">=</span><span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="va">epu</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data-raw/gis"</span><span class="op">)</span>, <span class="st">'EPU_extended'</span>, quiet<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">.</span>,crs<span class="op">=</span><span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="va">GB.strata</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data-raw/gis"</span><span class="op">)</span>, <span class="st">'EPU_strata'</span>, quiet<span class="op">=</span><span class="cn">T</span><span class="op">)</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">.</span>,crs<span class="op">=</span><span class="fl">4326</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Strata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Strata</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">MAB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1010</span><span class="op">:</span><span class="fl">1080</span>, <span class="fl">1100</span><span class="op">:</span><span class="fl">1120</span>, <span class="fl">1600</span><span class="op">:</span><span class="fl">1750</span>, <span class="fl">3010</span><span class="op">:</span><span class="fl">3450</span>, <span class="fl">3470</span>, <span class="fl">3500</span>, <span class="fl">3510</span><span class="op">)</span></span>
<span><span class="va">GB</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1090</span>, <span class="fl">1130</span><span class="op">:</span><span class="fl">1210</span>, <span class="fl">1230</span>, <span class="fl">1250</span>, <span class="fl">3460</span>, <span class="fl">3480</span>, <span class="fl">3490</span>, <span class="fl">3520</span><span class="op">:</span><span class="fl">3550</span><span class="op">)</span></span>
<span><span class="va">GOM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1220</span>, <span class="fl">1240</span>, <span class="fl">1260</span><span class="op">:</span><span class="fl">1290</span>, <span class="fl">1360</span><span class="op">:</span><span class="fl">1400</span>, <span class="fl">3560</span><span class="op">:</span><span class="fl">3830</span><span class="op">)</span></span>
<span><span class="va">SS</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1300</span><span class="op">:</span><span class="fl">1352</span>, <span class="fl">3840</span><span class="op">:</span><span class="fl">3990</span><span class="op">)</span></span>
<span></span>
<span><span class="va">epus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>EPU <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MAB"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">MAB</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"GB"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">GB</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"GOM"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">GOM</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"SS"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">SS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,STRATA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">MAB</span>,<span class="va">GB</span>,<span class="va">GOM</span>,<span class="va">SS</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="va">strata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">epus</span>,by<span class="op">=</span><span class="st">"STRATA"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">EPU</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">coast</span>,color <span class="op">=</span> <span class="st">"Grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">strata</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">epu</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EPU</span> <span class="op">==</span> <span class="st">"GB"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77</span>,<span class="op">-</span><span class="fl">65</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>,<span class="fl">45</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="GBSurveySet_files/figure-html/Survey_map-1.png" alt="Survey strata overlaid with Georges Bank EPU" width="672"><p class="caption">
(#fig:Survey_map)Survey strata overlaid with Georges Bank EPU
</p>
</div>
<p>Another option is to include only those strata that are at least 50% within the EPU boundary by area. This was the preferred method of the Northeast IEA program for their State of the Ecosystem report. The map below shows the strata that were included. The medium blue color represents Georges Bank.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">coast</span>,color <span class="op">=</span> <span class="st">"Grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">strata</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">EPU</span><span class="op">)</span>,color <span class="op">=</span> <span class="st">"Black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">epu</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EPU</span> <span class="op">==</span> <span class="st">"GB"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77</span>,<span class="op">-</span><span class="fl">65</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>,<span class="fl">45</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#0093D0'</span>, <span class="st">'#0055A4'</span>,<span class="st">'#00467F'</span>,<span class="st">'#007078'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SOE"></span>
<img src="GBSurveySet_files/figure-html/SOE-1.png" alt="Survey strata by EPU" width="672"><p class="caption">
Figure 1: Survey strata by EPU
</p>
</div>
<p>The difference between these two options would be the inclusion of strata 01100, 01110, and 01120 in the southwest corner of the EPU.</p>
</div>
<div class="section level3">
<h3 id="option-2---ignore-survey-design">Option 2 - ignore survey design<a class="anchor" aria-label="anchor" href="#option-2---ignore-survey-design"></a>
</h3>
<p>Ignoring the survey design leaves us with two options: a straight mean of the EPU or a post-stratified design. The first option creates large variances which make it difficult to conduct any kind of statistical testing. Other previous work by EDAB stratified Georges Bank into large strata based on whether the area was considered open access or withing a closed area, inside or outside of US waters, and the shelf break.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">coast</span>,color <span class="op">=</span> <span class="st">"Grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">GB.strata</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Strata</span><span class="op">)</span>,color <span class="op">=</span> <span class="st">"Black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Blues"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">72</span>,<span class="op">-</span><span class="fl">65</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">38</span>,<span class="fl">43</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GB"></span>
<img src="GBSurveySet_files/figure-html/GB-1.png" alt="Gearoges Bank EPU defined by survey strata" width="672"><p class="caption">
Figure 2: Gearoges Bank EPU defined by survey strata
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="testing-the-options">Testing the options<a class="anchor" aria-label="anchor" href="#testing-the-options"></a>
</h2>
<p>To see if there was an noticeable difference between the three options outlined above (All - Any strata that is at least partially within the GB EPU boundary, SOE - strata set used by the State of the Ecosystem report, and EPU - post-stratified EPU) biomass indices were calculated for the top 11 species that will be included in the MS Keyrun project.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#source(here('Survdat.r'))</span></span>
<span><span class="co">#load(here('data-raw/data/Survdat.RData'))</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">'data-raw/data/survdat_Albatross.RData'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">survdat</span> <span class="op">&lt;-</span> <span class="va">survdat.a4</span><span class="op">$</span><span class="va">survdat</span></span>
<span></span>
<span><span class="co">#Top 10(11) species</span></span>
<span><span class="va">top10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">23</span>, <span class="fl">32</span>, <span class="fl">72</span>, <span class="fl">73</span>, <span class="fl">74</span>, <span class="fl">75</span>, <span class="fl">105</span>, <span class="fl">106</span>, <span class="fl">121</span>, <span class="fl">197</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#fix numbers as character</span></span>
<span><span class="va">survdat</span> <span class="op">&lt;-</span> <span class="va">survdat</span><span class="op">[</span>, <span class="va">STRATUM</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">STRATUM</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">survdat</span> <span class="op">&lt;-</span> <span class="va">survdat</span><span class="op">[</span>, <span class="va">SVSPP</span>   <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">SVSPP</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#First with survey strata</span></span>
<span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data-raw/gis/strata.shp"</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run 1 - All strata for GB ()</span></span>
<span><span class="va">GB.soe</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1090</span>, <span class="fl">1130</span><span class="op">:</span><span class="fl">1210</span>, <span class="fl">1230</span>, <span class="fl">1250</span>, <span class="fl">3460</span>, <span class="fl">3480</span>, <span class="fl">3490</span>, <span class="fl">3520</span><span class="op">:</span><span class="fl">3550</span><span class="op">)</span></span>
<span><span class="va">GB.extra</span> <span class="op">&lt;-</span> <span class="fl">1100</span><span class="op">:</span><span class="fl">1120</span></span>
<span><span class="co">#Calculate stratified means</span></span>
<span><span class="va">all.mean</span> <span class="op">&lt;-</span> <span class="fu">survdat</span><span class="fu">::</span><span class="fu"><a href="https://noaa-edab.github.io/survdat/reference/calc_stratified_mean.html" class="external-link">calc_stratified_mean</a></span><span class="op">(</span><span class="va">survdat</span>,</span>
<span>                              areaPolygon <span class="op">=</span> <span class="va">strata</span>,</span>
<span>                              areaDescription <span class="op">=</span> <span class="st">"STRATA"</span>,</span>
<span>                              filterByArea <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">GB.soe</span>,<span class="va">GB.extra</span><span class="op">)</span>,</span>
<span>                              filterBySeason <span class="op">=</span> <span class="st">"FALL"</span>,</span>
<span>                              groupDescription <span class="op">=</span> <span class="st">"SVSPP"</span>,</span>
<span>                              filterByGroup <span class="op">=</span> <span class="va">top10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all.mean</span> <span class="op">&lt;-</span> <span class="va">all.mean</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">YEAR</span>, <span class="va">SVSPP</span>, <span class="va">strat.biomass</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">all.mean</span><span class="op">[</span>, <span class="va">subset</span> <span class="op">:=</span> <span class="st">'All'</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#Run 2 - SOE strata for GB ()</span></span>
<span><span class="co">#Calculate stratified means</span></span>
<span><span class="va">soe.mean</span> <span class="op">&lt;-</span> <span class="fu">survdat</span><span class="fu">::</span><span class="fu"><a href="https://noaa-edab.github.io/survdat/reference/calc_stratified_mean.html" class="external-link">calc_stratified_mean</a></span><span class="op">(</span><span class="va">survdat</span>,</span>
<span>                              areaPolygon <span class="op">=</span> <span class="va">strata</span>,</span>
<span>                              areaDescription <span class="op">=</span> <span class="st">"STRATA"</span>,</span>
<span>                              filterByArea <span class="op">=</span> <span class="va">GB.soe</span>,</span>
<span>                              filterBySeason <span class="op">=</span> <span class="st">"FALL"</span>,</span>
<span>                              groupDescription <span class="op">=</span> <span class="st">"SVSPP"</span>,</span>
<span>                              filterByGroup <span class="op">=</span> <span class="va">top10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">soe.mean</span> <span class="op">&lt;-</span> <span class="va">soe.mean</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">YEAR</span>, <span class="va">SVSPP</span>, <span class="va">strat.biomass</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">soe.mean</span><span class="op">[</span>, <span class="va">subset</span> <span class="op">:=</span> <span class="st">'SOE'</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#Run 3 - Use EPU strata</span></span>
<span><span class="co">#Grab strata</span></span>
<span><span class="va">epu</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data-raw/gis/EPU_strata.shp"</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Calculate stratified means</span></span>
<span><span class="va">epu.mean</span> <span class="op">&lt;-</span> <span class="fu">survdat</span><span class="fu">::</span><span class="fu"><a href="https://noaa-edab.github.io/survdat/reference/calc_stratified_mean.html" class="external-link">calc_stratified_mean</a></span><span class="op">(</span><span class="va">survdat</span>,</span>
<span>                              areaPolygon <span class="op">=</span> <span class="va">epu</span>,</span>
<span>                              areaDescription <span class="op">=</span> <span class="st">"Strata"</span>,</span>
<span>                              filterBySeason <span class="op">=</span> <span class="st">"FALL"</span>,</span>
<span>                              groupDescription <span class="op">=</span> <span class="st">"SVSPP"</span>,</span>
<span>                              filterByGroup <span class="op">=</span> <span class="va">top10</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">epu.mean</span> <span class="op">&lt;-</span> <span class="va">epu.mean</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">YEAR</span>, <span class="va">SVSPP</span>, <span class="va">strat.biomass</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">epu.mean</span><span class="op">[</span>, <span class="va">subset</span> <span class="op">:=</span> <span class="st">'EPU'</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#Combine data</span></span>
<span><span class="va">combo.data</span> <span class="op">&lt;-</span> <span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">all.mean</span>, <span class="va">soe.mean</span>, <span class="va">epu.mean</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">survey.plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combo.data</span>,</span>
<span>                      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">YEAR</span>, y <span class="op">=</span> <span class="va">strat.biomass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">subset</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">SVSPP</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">6</span>, scales <span class="op">=</span> <span class="st">'free_y'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">survey.plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="GBSurveySet_files/figure-html/test-1.png" width="672"></p>
<p>As you can see, all three spatial footprints give similar trends with only minimal differences in the magnitudes. Therefore it was decided at a working group meeting on 11/4/2020 to use the survey strata set from the State of the Ecosystem report. This accomplishes two goals. First it stays consistent with the survey design of the survey. Second it is consistent with other ecosystem products coming out of the Center.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andy Beet, Sean Lucey, Sarah Gaichas, Kiersten Curti.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
