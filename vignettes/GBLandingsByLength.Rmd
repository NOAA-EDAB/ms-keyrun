---
title: "Landings by Length for Georges Bank"
output:
  bookdown::html_document2:
    code_fold: hide
    number_sections: false
csl: apa-annotated-bibliography.csl
bibliography: references.bib
link-citations: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(mskeyrun)
options(warn=-1)
```

Landings of fish are not recorded by length. Samples of the landed fish are taken through time by port samplers at the request of the assessment scientist. The size of the samples (the number of fish sampled) and the frequency of the samples change through time for several reasons. As a result some species are more heavily sampled than others. In addition some species are more heavily sampled during certain times of the year. In many cases the lengthed fish are assigned a market category, for example, Large, Small, Jumbo. Other times they are not and are simple considered Unclassified

For many stock assessment models and multispecies models the catch is often required as a composition of lengths. Due to the nature of the sampling program, length samples are not always available at the level the model requires. In this case there are several options. One of them being to "borrow" length samples from adjacent time periods. This assumes that fish caught from one time period to the next have similar size (length) distributions.

## Expanding catch to a composition of lengths

For each of the [focal species](stockAreas.html#focal) the annual catch (measured in metric tons) is expanded to a composition of length. The result being that the sum of the catch over all lengths in a given year (or any other time interval) will equal the total catch for that year (or equivalent time interval). Fish are measured in 1 cm increments.


* Commercial fisheries landings were pulled using R package [`comlandr`](https://github.com/NOAA-EDAB/comlandr)

* The length data were pulled from the `stockeff.mv_cf_len` table

* The R package [`mscatch`](https://noaa-edab.github.io/mscatch/) is used to expand the annual catch data. The methods are explained there. 


For each species, a set of rules are applied (similar to the approach taken in a stock assessment), to determine how the landings and discard data are aggregated based on the availability of length samples. Biomass (metric tons) is then estimated for each LENGTH (1 cm bins) category by YEAR and [fleet](https://noaa-edab.github.io/ms-keyrun/GBFleetDecisions.html). This data set is exported in the package as [`realFisheryLencomp`](https://noaa-edab.github.io/ms-keyrun/reference/realFisheryLencomp.html)

```{r lencomp,echo=T,eval=TRUE}
mskeyrun::realFisheryLencomp %>%
  dplyr::filter(Code == 164712) %>%
  head(.,10) %>%
  flextable::flextable() %>% 
  flextable::colformat_num(j=c("Code","year"), big.mark = "" , digits=0 )
```




## References

